# Rocky Linux 그라파나(Grafana) 설정 및 활용 가이드

이 문서는 Rocky Linux 환경에서 그라파나를 설치하고, 프로메테우스와 연동하여 대시보드를 구성하는 전체 과정을 설명합니다.

---

## 1. 그라파나(Grafana) 개요
그라파나는 다양한 데이터 소스로부터 수집된 시계열 데이터를 시각화하는 중앙 관제탑 역할을 합니다. 프로메테우스가 데이터를 수집하고 저장한다면, 그라파나는 그 데이터를 사용자가 보기 편한 그래프와 차트로 그려냅니다.

## 2. 설치 및 실행

### 2.1 저장소 설정 및 설치
로키 리눅스의 패키지 매니저(dnf)를 통해 공식 버전을 설치합니다.

```bash
# 1. 저장소 파일 생성
sudo vi /etc/yum.repos.d/grafana.repo
```

**[파일 내용]**
```ini
[grafana]
name=grafana
baseurl=https://rpm.grafana.com
repo_gpgcheck=1
enabled=1
gpgcheck=1
gpgkey=https://rpm.grafana.com/gpg.key
sslverify=1
sslcacert=/etc/pki/tls/certs/ca-bundle.crt
```

```bash
# 2. 패키지 설치
sudo dnf install grafana -y
```

### 2.2 서비스 관리 및 방화벽 설정
```bash
# 서비스 자동 실행 및 시작
sudo systemctl enable --now grafana-server
```

## 3. 초기 접속 및 로그인
웹 브라우저에서 다음 주소로 접속합니다: `http://서버_IP:3000`

*   **초기 계정**: ID `admin` / PW `admin`
*   **비밀번호 변경**: 최초 로그인 시 반드시 새로운 비밀번호로 변경해야 합니다.

## 4. 데이터 소스 연동 (Prometheus)
그라파나가 프로메테우스의 데이터를 가져올 수 있도록 연결 경로를 설정합니다.

1.  좌측 메뉴: **Connections** > **Data Sources** 클릭
2.  **Add data source** 버튼 클릭 후 **Prometheus** 선택
3.  **Connection 설정**:
    *   URL: `http://localhost:9090` (같은 서버에 설치된 경우)
4.  하단 **Save & test** 버튼을 눌러 "Successfully queried the Prometheus API" 메시지 확인

## 5. 대시보드 구성 (Import 방식)
이미 한글 번역이 완료된 대시보드 설정 파일(`dash_board_ko.json`)을 사용하여 빠르게 대시보드를 구성할 수 있습니다.

### 5.1 한글화 대시보드 적용 (추천)
기존 Node Exporter Full(ID: 1860) 대시보드를 기반으로 주요 항목들을 초보자가 이해하기 쉽게 한글로 번역한 설정을 적용합니다.

1.  좌측 메뉴: **Dashboards** 클릭
2.  **New** > **Import** 선택
3.  **Import via dashboard JSON model**: 준비된 `dash_board_ko.json` 파일내용을 붙여 넣습니다.
4.  **Prometheus 선택**: 하단 `prometheus` 드롭다운 메뉴에서 미리 연동한 데이터 소스를 선택합니다.
5.  **Import** 버튼 클릭

## 6. 대시보드 주요 기능 설명
*   **Panel (패널)**: 개별 그래프나 차트 단위입니다. 각 패널은 특정한 PromQL(쿼리)을 실행하여 결과를 보여줍니다.
*   **Variables (변수)**: 대시보드 상단에서 특정 서버나 대상을 필터링할 때 사용합니다.
*   **Time Range (시간 범위)**: 우측 상단에서 과거 5분, 1시간, 7일 등 조회 기간을 자유롭게 변경합니다.
*   **Refresh (갱신 주기)**: 데이터가 자동으로 업데이트되는 주기를 설정합니다 (예: 5초, 1분).

## 7. 운영 및 유지보수
*   **설정 파일 위치**: `/etc/grafana/grafana.ini` (포트 변경이나 도메인 설정 시 수정)
*   **로그 파일 위치**: `/var/log/grafana/grafana.log`
*   **데이터 저장소**: `/var/lib/grafana/` (대시보드 설정 및 사용자 정보가 저장됨)

> **참고**: 이 가이드는 프로메테우스가 이미 설치되어 9090 포트에서 동작 중임을 가정합니다. 만약 서버 지표가 보이지 않는다면 수집기인 Node Exporter가 대상 서버에서 실행 중인지 확인해야 합니다.
